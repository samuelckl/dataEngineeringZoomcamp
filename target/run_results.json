{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.9.2", "generated_at": "2025-02-26T12:56:29.155322Z", "invocation_id": "bac9f5a9-ffdc-465a-a95d-07240cad2928", "env": {}}, "results": [{"status": "error", "timing": [{"name": "compile", "started_at": "2025-02-26T12:56:28.138863Z", "completed_at": "2025-02-26T12:56:28.160622Z"}, {"name": "execute", "started_at": "2025-02-26T12:56:28.160927Z", "completed_at": "2025-02-26T12:56:29.093661Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.9695501327514648, "adapter_response": {}, "message": "Database Error in model dim_zones (models/core/dim_zones.sql)\n  Not found: Table dataengineering-449109:zoomcamp_dataset.taxi_zone_lookup was not found in location US\n  compiled code at target/run/taxi_rides_ny/models/core/dim_zones.sql", "failures": null, "unique_id": "model.taxi_rides_ny.dim_zones", "compiled": true, "compiled_code": "\n\nselect \n    locationid, \n    borough, \n    zone, \n    replace(service_zone,'Boro','Green') as service_zone \nfrom `dataengineering-449109`.`zoomcamp_dataset`.`taxi_zone_lookup`", "relation_name": "`dataengineering-449109`.`zoomcamp_dataset`.`dim_zones`", "batch_results": null}, {"status": "error", "timing": [{"name": "compile", "started_at": "2025-02-26T12:56:28.154095Z", "completed_at": "2025-02-26T12:56:28.166923Z"}, {"name": "execute", "started_at": "2025-02-26T12:56:28.195718Z", "completed_at": "2025-02-26T12:56:29.137123Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 1.0031559467315674, "adapter_response": {}, "message": "Database Error in model stg_yellow_tripdata (models/staging/stg_yellow_tripdata.sql)\n  Access Denied: Table dbt_samuelckl:trips_data_all.yellow_tripdata: User does not have permission to query table dbt_samuelckl:trips_data_all.yellow_tripdata, or perhaps it does not exist.\n  compiled code at target/run/taxi_rides_ny/models/staging/stg_yellow_tripdata.sql", "failures": null, "unique_id": "model.taxi_rides_ny.stg_yellow_tripdata", "compiled": true, "compiled_code": "\n \nwith tripdata as \n(\n  select *,\n    row_number() over(partition by vendorid, tpep_pickup_datetime) as rn\n  from `dbt_samuelckl`.`trips_data_all`.`yellow_tripdata`\n  where vendorid is not null \n)\nselect\n   -- identifiers\n    to_hex(md5(cast(coalesce(cast(vendorid as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(tpep_pickup_datetime as string), '_dbt_utils_surrogate_key_null_') as string))) as tripid,    \n    safe_cast(vendorid as INT64) as vendorid,\n    safe_cast(ratecodeid as INT64) as ratecodeid,\n    safe_cast(pulocationid as INT64) as pickup_locationid,\n    safe_cast(dolocationid as INT64) as dropoff_locationid,\n\n    -- timestamps\n    cast(tpep_pickup_datetime as timestamp) as pickup_datetime,\n    cast(tpep_dropoff_datetime as timestamp) as dropoff_datetime,\n    \n    -- trip info\n    store_and_fwd_flag,\n    safe_cast(passenger_count as INT64) as passenger_count,\n    cast(trip_distance as numeric) as trip_distance,\n    -- yellow cabs are always street-hail\n    1 as trip_type,\n    \n    -- payment info\n    cast(fare_amount as numeric) as fare_amount,\n    cast(extra as numeric) as extra,\n    cast(mta_tax as numeric) as mta_tax,\n    cast(tip_amount as numeric) as tip_amount,\n    cast(tolls_amount as numeric) as tolls_amount,\n    cast(0 as numeric) as ehail_fee,\n    cast(improvement_surcharge as numeric) as improvement_surcharge,\n    cast(total_amount as numeric) as total_amount,\n    coalesce(safe_cast(payment_type as INT64),0) as payment_type,\n    case safe_cast(payment_type as INT64)  \n        when 1 then 'Credit card'\n        when 2 then 'Cash'\n        when 3 then 'No charge'\n        when 4 then 'Dispute'\n        when 5 then 'Unknown'\n        when 6 then 'Voided trip'\n        else 'EMPTY'\n    end as payment_type_description\nfrom tripdata\nwhere rn = 1\n\n-- dbt build --select <model.sql> --vars '{'is_test_run: false}'\n\n\n  limit 100\n\n", "relation_name": "`dataengineering-449109`.`zoomcamp_dataset`.`stg_yellow_tripdata`", "batch_results": null}, {"status": "error", "timing": [{"name": "compile", "started_at": "2025-02-26T12:56:28.146511Z", "completed_at": "2025-02-26T12:56:28.166719Z"}, {"name": "execute", "started_at": "2025-02-26T12:56:28.185486Z", "completed_at": "2025-02-26T12:56:29.145072Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 1.0110642910003662, "adapter_response": {}, "message": "Database Error in model stg_green_tripdata (models/staging/stg_green_tripdata.sql)\n  Access Denied: Table dbt_samuelckl:trips_data_all.green_tripdata: User does not have permission to query table dbt_samuelckl:trips_data_all.green_tripdata, or perhaps it does not exist.\n  compiled code at target/run/taxi_rides_ny/models/staging/stg_green_tripdata.sql", "failures": null, "unique_id": "model.taxi_rides_ny.stg_green_tripdata", "compiled": true, "compiled_code": "\n\nwith tripdata as \n(\n  select *,\n    row_number() over(partition by vendorid, lpep_pickup_datetime) as rn\n  from `dbt_samuelckl`.`trips_data_all`.`green_tripdata`\n  where vendorid is not null \n)\nselect\n    -- identifiers\n    to_hex(md5(cast(coalesce(cast(vendorid as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(lpep_pickup_datetime as string), '_dbt_utils_surrogate_key_null_') as string))) as tripid,\n    safe_cast(vendorid as INT64) as vendorid,\n    safe_cast(ratecodeid as INT64) as ratecodeid,\n    safe_cast(pulocationid as INT64) as pickup_locationid,\n    safe_cast(dolocationid as INT64) as dropoff_locationid,\n    \n    -- timestamps\n    cast(lpep_pickup_datetime as timestamp) as pickup_datetime,\n    cast(lpep_dropoff_datetime as timestamp) as dropoff_datetime,\n    \n    -- trip info\n    store_and_fwd_flag,\n    safe_cast(passenger_count as INT64) as passenger_count,\n    cast(trip_distance as numeric) as trip_distance,\n    safe_cast(trip_type as INT64) as trip_type,\n\n    -- payment info\n    cast(fare_amount as numeric) as fare_amount,\n    cast(extra as numeric) as extra,\n    cast(mta_tax as numeric) as mta_tax,\n    cast(tip_amount as numeric) as tip_amount,\n    cast(tolls_amount as numeric) as tolls_amount,\n    cast(ehail_fee as numeric) as ehail_fee,\n    cast(improvement_surcharge as numeric) as improvement_surcharge,\n    cast(total_amount as numeric) as total_amount,\n    coalesce(safe_cast(payment_type as INT64),0) as payment_type,\n    case safe_cast(payment_type as INT64)  \n        when 1 then 'Credit card'\n        when 2 then 'Cash'\n        when 3 then 'No charge'\n        when 4 then 'Dispute'\n        when 5 then 'Unknown'\n        when 6 then 'Voided trip'\n        else 'EMPTY'\n    end as payment_type_description\nfrom tripdata\nwhere rn = 1\n\n\n-- dbt build --select <model_name> --vars '{'is_test_run': 'false'}'\n\n\n  limit 100\n\n", "relation_name": "`dataengineering-449109`.`zoomcamp_dataset`.`stg_green_tripdata`", "batch_results": null}, {"status": "skipped", "timing": [], "thread_id": "Thread-4 (worker)", "execution_time": 0, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.taxi_rides_ny.fact_trips", "compiled": false, "compiled_code": null, "relation_name": "`dataengineering-449109`.`zoomcamp_dataset`.`fact_trips`", "batch_results": null}, {"status": "skipped", "timing": [], "thread_id": "Thread-3 (worker)", "execution_time": 0, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.taxi_rides_ny.dm_monthly_zone_revenue", "compiled": false, "compiled_code": null, "relation_name": "`dataengineering-449109`.`zoomcamp_dataset`.`dm_monthly_zone_revenue`", "batch_results": null}], "elapsed_time": 2.582780122756958, "args": {"source_freshness_run_project_hooks": false, "write_json": true, "select": [], "log_format": "default", "use_colors_file": true, "project_dir": "/Users/kinlokchan/dataEngineeringZoomcamp/data-engineering-zoomcamp/04-analytics-engineering/taxi_rides_ny", "macro_debugging": false, "partial_parse_file_diff": true, "favor_state": false, "state_modified_compare_vars": false, "version_check": true, "require_batched_execution_for_custom_microbatch_strategy": false, "use_colors": true, "defer": false, "log_path": "/Users/kinlokchan/dataEngineeringZoomcamp/data-engineering-zoomcamp/04-analytics-engineering/taxi_rides_ny/logs", "skip_nodes_if_on_run_start_fails": false, "require_nested_cumulative_type_params": false, "empty": false, "cache_selected_only": false, "introspect": true, "partial_parse": true, "show_resource_report": false, "quiet": false, "strict_mode": false, "print": true, "vars": {}, "exclude": [], "warn_error_options": {"include": [], "exclude": []}, "require_explicit_package_overrides_for_builtin_materializations": true, "log_file_max_bytes": 10485760, "log_level": "info", "populate_cache": true, "printer_width": 80, "require_yaml_configuration_for_mf_time_spines": false, "state_modified_compare_more_unrendered_values": false, "log_level_file": "debug", "send_anonymous_usage_stats": true, "indirect_selection": "eager", "which": "run", "static_parser": true, "profiles_dir": "/Users/kinlokchan/.dbt", "require_resource_names_without_spaces": false, "invocation_command": "dbt run", "log_format_file": "debug"}}